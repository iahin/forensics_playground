,ttp,Description,Log Source,Detection Rules,False Positive Rules,APT Group
0,attack.t1566.001,Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage|endswith': '\\Hwp.exe', 'Image|endswith': '\\gbb.exe'}, 'condition': 'selection'}",['Unknown'],G0099
1,attack.t1566.001,Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other sub processes like mshta.exe,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage|endswith': '\\EQNEDT32.EXE'}, 'condition': 'selection'}",['unknown'],G0099
2,attack.t1566.001,Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits for CVE-2017-0261 and CVE-2017-0262,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage|endswith': '\\WINWORD.EXE', 'Image|contains': '\\FLTLDR.exe'}, 'condition': 'selection'}","['Several false positives identified, check for suspicious file names or locations (e.g. Temp folders)']",G0099
3,attack.t1566.001,Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage|endswith': '\\WINWORD.EXE', 'Image|endswith': '\\csc.exe'}, 'condition': 'selection'}",['Unknown'],G0099
4,attack.t1566.001,"Detects suspicious use of an .exe extension after a non-executable file extension like .pdf.exe, a set of spaces or underlines to cloak the executable file in spear phishing campaigns","{'category': 'process_creation', 'product': 'windows'}","{'selection': {'Image|endswith': ['.doc.exe', '.docx.exe', '.xls.exe', '.xlsx.exe', '.ppt.exe', '.pptx.exe', '.rtf.exe', '.pdf.exe', '.txt.exe', '      .exe', '______.exe']}, 'condition': 'selection'}",['Unknown'],G0099
5,attack.t1566.001,"Alerts on trust record modification within the registry, indicating usage of macros","{'category': 'registry_event', 'product': 'windows'}","{'selection': {'TargetObject|contains': 'TrustRecords'}, 'condition': 'selection'}","['Alerts on legitimate macro usage as well, will need to filter as appropriate']",G0099
6,attack.t1566.001,Detects a suspicious program execution in Outlook temp folder,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'Image|contains': '\\Temporary Internet Files\\Content.Outlook\\\\'}, 'condition': 'selection'}",['Unknown'],G0099
7,attack.t1204.002,Detects DSParse DLL being loaded by an Office Product,"{'category': 'image_load', 'product': 'windows'}","{'selection': {'Image|endswith': ['\\winword.exe', '\\powerpnt.exe', '\\excel.exe', '\\outlook.exe'], 'ImageLoaded|contains': ['\\dsparse.dll']}, 'condition': 'selection'}","['Alerts on legitimate macro usage as well, will need to filter as appropriate']",G0099
8,attack.t1204.002,Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other sub processes like mshta.exe,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage|endswith': '\\EQNEDT32.EXE'}, 'condition': 'selection'}",['unknown'],G0099
9,attack.t1204.002,"Detects a Windows command and scripting interpreter executable started from Microsoft Word, Excel, Powerpoint, Publisher and Visio","{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage|endswith': ['\\WINWORD.EXE', '\\EXCEL.EXE', '\\POWERPNT.exe', '\\MSPUB.exe', '\\VISIO.exe', '\\OUTLOOK.EXE', '\\MSACCESS.EXE', '\\EQNEDT32.EXE'], 'Image|endswith': ['\\cmd.exe', '\\powershell.exe', '\\wscript.exe', '\\cscript.exe', '\\sh.exe', '\\bash.exe', '\\scrcons.exe', '\\schtasks.exe', '\\regsvr32.exe', '\\hh.exe', '\\wmic.exe', '\\mshta.exe', '\\rundll32.exe', '\\msiexec.exe', '\\forfiles.exe', '\\scriptrunner.exe', '\\mftrace.exe', '\\AppVLP.exe', '\\svchost.exe', '\\msbuild.exe']}, 'condition': 'selection'}",['unknown'],G0099
10,attack.t1204.002,Detects any GAC DLL being loaded by an Office Product,"{'category': 'image_load', 'product': 'windows'}","{'selection': {'Image|endswith': ['\\winword.exe', '\\powerpnt.exe', '\\excel.exe', '\\outlook.exe'], 'ImageLoaded|startswith': ['C:\\Windows\\Microsoft.NET\\assembly\\GAC_MSIL']}, 'condition': 'selection'}","['Alerts on legitimate macro usage as well, will need to filter as appropriate']",G0099
11,attack.t1204.002,Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits for CVE-2017-0261 and CVE-2017-0262,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage|endswith': '\\WINWORD.EXE', 'Image|contains': '\\FLTLDR.exe'}, 'condition': 'selection'}","['Several false positives identified, check for suspicious file names or locations (e.g. Temp folders)']",G0099
12,attack.t1204.002,Detects specific process characteristics of Maze ransomware word document droppers,"{'category': 'process_creation', 'product': 'windows'}","{'selection1': {'ParentImage|endswith': ['\\WINWORD.exe'], 'Image|endswith': ['*.tmp']}, 'selection2': {'Image|endswith': '\\wmic.exe', 'ParentImage|contains': '\\Temp\\', 'CommandLine|endswith': 'shadowcopy delete'}, 'selection3': {'CommandLine|endswith': 'shadowcopy delete', 'CommandLine|contains': '\\..\\..\\system32'}, 'condition': '1 of them'}",['Unlikely'],G0099
13,attack.t1204.002,"Detect run not allowed files. Applocker is a very useful tool, especially on servers where unprivileged users have access. For example terminal servers. You need configure applocker and log collect to receive these events.","{'product': 'windows', 'service': 'applocker'}","{'selection': {'EventID': [8004, 8007]}, 'condition': 'selection'}",['need tuning applocker or add exceptions in SIEM'],G0099
14,attack.t1204.002,Detects Kerberos DLL being loaded by an Office Product,"{'category': 'image_load', 'product': 'windows'}","{'selection': {'Image|endswith': ['\\winword.exe', '\\powerpnt.exe', '\\excel.exe', '\\outlook.exe'], 'ImageLoaded|endswith': ['\\kerberos.dll']}, 'condition': 'selection'}","['Alerts on legitimate macro usage as well, will need to filter as appropriate']",G0099
15,attack.t1204.002,Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage|endswith': '\\WINWORD.EXE', 'Image|endswith': '\\csc.exe'}, 'condition': 'selection'}",['Unknown'],G0099
16,attack.t1204.002,A General detection for a new application in AppCompat. This indicates an application executing for the first time on an endpoint.,"{'product': 'windows', 'category': 'registry_event'}","{'selection': {'TargetObject|contains': '\\AppCompatFlags\\Compatibility Assistant\\Store\\'}, 'condition': 'selection'}","['This rule is to explore new applications on an endpoint. False positives depends on the organization.', 'Newly setup system.', 'Legitimate installation of new application.']",G0099
17,attack.t1204.002,Detects CLR DLL being loaded by an Office Product,"{'category': 'image_load', 'product': 'windows'}","{'selection': {'Image|endswith': ['\\winword.exe', '\\powerpnt.exe', '\\excel.exe', '\\outlook.exe'], 'ImageLoaded|contains': ['\\clr.dll']}, 'condition': 'selection'}","['Alerts on legitimate macro usage as well, will need to filter as appropriate']",G0099
18,attack.t1204.002,Detects DLL's Loaded Via Word Containing VBA Macros,"{'category': 'image_load', 'product': 'windows'}","{'selection': {'Image|endswith': ['\\winword.exe', '\\powerpnt.exe', '\\excel.exe', '\\outlook.exe'], 'ImageLoaded|endswith': ['\\VBE7.DLL', '\\VBEUI.DLL', '\\VBE7INTL.DLL']}, 'condition': 'selection'}","['Alerts on legitimate macro usage as well, will need to filter as appropriate']",G0099
19,attack.t1204.002,"Detects an executable in the users directory started from Microsoft Word, Excel, Powerpoint, Publisher or Visio","{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage|endswith': ['\\WINWORD.EXE', '\\EXCEL.EXE', '\\POWERPNT.exe', '\\MSPUB.exe', '\\VISIO.exe'], 'Image|startswith': 'C:\\users\\', 'Image|endswith': '.exe'}, 'filter': {'Image|endswith': '\\Teams.exe'}, 'condition': 'selection and not filter'}",['unknown'],G0099
20,attack.t1204.002,Detects any assembly DLL being loaded by an Office Product,"{'category': 'image_load', 'product': 'windows'}","{'selection': {'Image|endswith': ['\\winword.exe', '\\powerpnt.exe', '\\excel.exe', '\\outlook.exe'], 'ImageLoaded|startswith': ['C:\\Windows\\assembly\\']}, 'condition': 'selection'}","['Alerts on legitimate macro usage as well, will need to filter as appropriate']",G0099
21,attack.t1071.001,Execution of well known tools for data exfiltration and tunneling,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'Image|endswith': ['\\plink.exe', '\\socat.exe', '\\stunnel.exe', '\\httptunnel.exe']}, 'condition': 'selection'}",['Legitimate Administrator using tools'],G0026
22,attack.t1571,Detects programs that connect to typical malware back connect ports based on statistical analysis from two different sandbox system databases,"{'category': 'network_connection', 'product': 'windows', 'definition': 'Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=""include""><CallTrace condition=""contains"">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=""exclude""><CallTrace condition=""excludes"">UNKNOWN</CallTrace></ProcessAccess>'}","{'selection': {'Initiated': 'true', 'DestinationPort': ['4443', '2448', '8143', '1777', '1443', '243', '65535', '13506', '3360', '200', '198', '49180', '13507', '6625', '4444', '4438', '1904', '13505', '13504', '12102', '9631', '5445', '2443', '777', '13394', '13145', '12103', '5552', '3939', '3675', '666', '473', '5649', '4455', '4433', '1817', '100', '65520', '1960', '1515', '743', '700', '14154', '14103', '14102', '12322', '10101', '7210', '4040', '9943']}, 'filter1': {'Image|contains': '\\Program Files'}, 'filter2': {'DestinationIp|startswith': ['10.', '192.168.', '172.16.', '172.17.', '172.18.', '172.19.', '172.20.', '172.21.', '172.22.', '172.23.', '172.24.', '172.25.', '172.26.', '172.27.', '172.28.', '172.29.', '172.30.', '172.31.', '127.'], 'DestinationIsIpv6': 'false'}, 'condition': 'selection and not ( filter1 or filter2 )'}",['unknown'],G0099
23,attack.t1041,Execution of well known tools for data exfiltration and tunneling,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'Image|endswith': ['\\plink.exe', '\\socat.exe', '\\stunnel.exe', '\\httptunnel.exe']}, 'condition': 'selection'}",['Legitimate Administrator using tools'],G0022
24,attack.t1041,The PowerShell implementation of DNSCat2 calls nslookup to craft queries. Counting nslookup processes spawned by PowerShell will show hundreds or thousands of instances if PS DNSCat2 is active locally.,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage|endswith': '\\powershell.exe', 'Image|endswith': '\\nslookup.exe', 'CommandLine|endswith': '\\nslookup.exe'}, 'condition': 'selection | count(Image) by ParentImage > 100'}",['Other powershell scripts that call nslookup.exe'],G0022
25,attack.t1059.003,Detects the exploitation of Zoho ManageEngine Desktop Central Java Deserialization vulnerability reported as CVE-2020-10189,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage|endswith': 'DesktopCentral_Server\\jre\\bin\\java.exe', 'Image|endswith': ['\\cmd.exe', '\\powershell.exe', '\\bitsadmin.exe']}, 'condition': 'selection'}",['Unknown'],G0006
26,attack.t1059.003,Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage|endswith': '\\Hwp.exe', 'Image|endswith': '\\gbb.exe'}, 'condition': 'selection'}",['Unknown'],G0006
27,attack.t1059.003,Detects Trojan loader acitivty as used by APT28,"{'category': 'process_creation', 'product': 'windows'}","{'selection1': {'CommandLine|contains|all': ['rundll32.exe', '%APPDATA%\\']}, 'selection2': [{'CommandLine|contains': '.dat"",'}, {'CommandLine|endswith': '.dll"",#1'}], 'condition': 'selection1 and selection2'}",['Unknown'],G0006
28,attack.t1059.003,Detects a suspicious child process of a Microsoft HTML Help system when executing compiled HTML files (.chm),"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage': 'C:\\Windows\\hh.exe', 'Image|endswith': ['\\cmd.exe', '\\powershell.exe', '\\wscript.exe', '\\cscript.exe', '\\regsvr32.exe', '\\wmic.exe', '\\rundll32.exe']}, 'condition': 'selection'}",['unknown'],G0006
29,attack.t1059.003,Detects actions caused by the RedMimicry Winnti playbook,"{'product': 'windows', 'category': 'process_creation'}","{'selection': {'Image|contains': ['rundll32.exe', 'cmd.exe'], 'CommandLine|contains': ['gthread-3.6.dll', '\\Windows\\Temp\\tmp.bat', 'sigcmm-2.4.dll']}, 'condition': 'selection'}",['Unknown'],G0006
30,attack.t1059.003,"Detect run not allowed files. Applocker is a very useful tool, especially on servers where unprivileged users have access. For example terminal servers. You need configure applocker and log collect to receive these events.","{'product': 'windows', 'service': 'applocker'}","{'selection': {'EventID': [8004, 8007]}, 'condition': 'selection'}",['need tuning applocker or add exceptions in SIEM'],G0006
31,attack.t1059.003,Detect various execution methods of the CrackMapExec pentesting framework,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'CommandLine|endswith': ['cmd.exe /Q /c * 1> \\\\\\\\*\\\\*\\\\* 2>&1', 'cmd.exe /C * > \\\\\\\\*\\\\*\\\\* 2>&1', 'cmd.exe /C * > *\\\\Temp\\\\* 2>&1'], 'CommandLine|contains': ['powershell.exe -exec bypass -noni -nop -w 1 -C ""', 'powershell.exe -noni -nop -w 1 -enc ']}, 'condition': 'selection'}",['Unknown'],G0006
32,attack.t1059.003,Detects activity that could be related to Baby Shark malware,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'CommandLine': ['reg query ""HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default""', 'powershell.exe mshta.exe http*', 'cmd.exe /c taskkill /im cmd.exe']}, 'condition': 'selection'}",['unknown'],G0006
33,attack.t1059.003,Detects exploitation attempt of privilege escalation vulnerability via SetupComplete.cmd and PartnerSetupComplete.cmd described in CVE-2019-1378,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentCommandLine|contains|all': ['\\cmd.exe', '/c', 'C:\\Windows\\Setup\\Scripts\\'], 'ParentCommandLine|endswith': ['SetupComplete.cmd', 'PartnerSetupComplete.cmd']}, 'filter': {'Image|startswith': ['C:\\Windows\\System32\\', 'C:\\Windows\\SysWOW64\\', 'C:\\Windows\\WinSxS\\', 'C:\\Windows\\Setup\\']}, 'condition': 'selection and not filter'}",['Unknown'],G0006
34,attack.t1059.003,Detects Elise backdoor acitivty as used by APT32,"{'category': 'process_creation', 'product': 'windows'}","{'selection1': {'Image': 'C:\\Windows\\SysWOW64\\cmd.exe', 'CommandLine|contains': '\\Windows\\Caches\\NavShExt.dll '}, 'selection2': {'CommandLine|endswith': '\\AppData\\Roaming\\MICROS~1\\Windows\\Caches\\NavShExt.dll,Setting'}, 'condition': '1 of them'}",['Unknown'],G0006
35,attack.t1059.003,Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell),"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'Image|endswith': '\\cmd.exe', 'CommandLine|contains|all': ['http', '://', '%AppData%']}, 'condition': 'selection'}",['High'],G0006
36,attack.t1059.003,detects the usage of path traversal in cmd.exe indicating possible command/argument confusion/hijacking,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentCommandLine|contains|all': ['cmd', '/c'], 'CommandLine|contains': '/../../'}, 'condition': 'selection'}",['(not much) some benign Java tools may product false-positive commandlines for loading libraries'],G0006
37,attack.t1059.003,Detects a ZxShell start by the called and well-known function name,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'Image|endswith': ['\\rundll32.exe'], 'CommandLine|contains': ['zxFunction', 'RemoteDiskXXXXX']}, 'condition': 'selection'}",['Unlikely'],G0006
38,attack.t1059.003,Detects command line parameters used by Koadic hack tool,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'Image|endswith': '\\cmd.exe', 'CommandLine|contains|all': ['/q', '/c', 'chcp']}, 'condition': 'selection'}",['Pentest'],G0006
39,attack.t1036.005,Detects tools and process executions as observed in a Greenbug campaign in May 2020,"{'category': 'process_creation', 'product': 'windows'}","{'selection1': {'CommandLine|contains|all': ['bitsadmin', '/transfer', 'CSIDL_APPDATA']}, 'selection2': {'CommandLine|contains': ['CSIDL_SYSTEM_DRIVE']}, 'selection3': {'CommandLine|contains': ['\\msf.ps1', '8989 -e cmd.exe', 'system.Data.SqlClient.SqlDataAdapter($cmd); [void]$da.fill', '-nop -w hidden -c $k=new-object', '[Net.CredentialCache]::DefaultCredentials;IEX ', ' -nop -w hidden -c $m=new-object net.webclient;$m', '-noninteractive -executionpolicy bypass whoami', '-noninteractive -executionpolicy bypass netstat -a', 'L3NlcnZlc']}, 'selection4': {'Image|endswith': ['\\adobe\\Adobe.exe', '\\oracle\\local.exe', '\\revshell.exe', 'infopagesbackup\\ncat.exe', 'CSIDL_SYSTEM\\cmd.exe', '\\programdata\\oracle\\java.exe', 'CSIDL_COMMON_APPDATA\\comms\\comms.exe', '\\Programdata\\VMware\\Vmware.exe']}, 'condition': '1 of them'}",['Unknown'],G0006
40,attack.t1036.005,Detects suspicious msiexec process starts in an uncommon directory,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'Image|endswith': '\\msiexec.exe'}, 'filter': {'Image|startswith': ['C:\\Windows\\System32\\', 'C:\\Windows\\SysWOW64\\', 'C:\\Windows\\WinSxS\\']}, 'condition': 'selection and not filter'}",['Unknown'],G0006
41,attack.t1036.005,Detects Winword starting uncommon sub process MicroScMgmt.exe as used in exploits for CVE-2015-1641,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'ParentImage|endswith': '\\WINWORD.EXE', 'Image|endswith': '\\MicroScMgmt.exe'}, 'condition': 'selection'}",['Unknown'],G0006
42,attack.t1036.005,Detects a suspicious svchost process start,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'Image|endswith': '\\svchost.exe'}, 'filter': {'ParentImage|endswith': ['\\services.exe', '\\MsMpEng.exe', '\\Mrt.exe', '\\rpcnet.exe', '\\svchost.exe']}, 'filter_null': {'ParentImage': None}, 'condition': 'selection and not filter and not filter_null'}",['Unknown'],G0006
43,attack.t1036.005,Detects the creation of a executable with a system process name in a suspicious folder,"{'category': 'file_event', 'product': 'windows'}","{'selection': {'TargetFilename|endswith': ['\\svchost.exe', '\\rundll32.exe', '\\services.exe', '\\powershell.exe', '\\regsvr32.exe', '\\spoolsv.exe', '\\lsass.exe', '\\smss.exe', '\\csrss.exe', '\\conhost.exe', '\\wininit.exe', '\\lsm.exe', '\\winlogon.exe', '\\explorer.exe', '\\taskhost.exe', '\\Taskmgr.exe', '\\taskmgr.exe', '\\sihost.exe', '\\RuntimeBroker.exe', '\\runtimebroker.exe', '\\smartscreen.exe', '\\dllhost.exe', '\\audiodg.exe', '\\wlanext.exe']}, 'filter': {'TargetFilename|startswith': ['C:\\Windows\\System32\\', 'C:\\Windows\\system32\\', 'C:\\Windows\\SysWow64\\', 'C:\\Windows\\SysWOW64\\', 'C:\\Windows\\winsxs\\', 'C:\\Windows\\WinSxS\\', '\\SystemRoot\\System32\\']}, 'condition': 'selection and not filter'}",['System processes copied outside the default folder'],G0006
44,attack.t1036.005,Detects executables launched outside their default directories as used by Lazarus Group (Bluenoroff),"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'Image|endswith': ['\\msdtc.exe', '\\gpvc.exe']}, 'filter': {'Image|startswith': ['C:\\Windows\\System32\\', 'C:\\Windows\\SysWOW64\\']}, 'condition': 'selection and not filter'}",['unknown'],G0006
45,attack.t1036.005,Detect suspicious parent processes of well-known Windows processes,"{'category': 'process_creation', 'product': 'windows'}","{'selection': {'Image|endswith': ['\\svchost.exe', '\\taskhost.exe', '\\lsm.exe', '\\lsass.exe', '\\services.exe', '\\lsaiso.exe', '\\csrss.exe', '\\wininit.exe', '\\winlogon.exe']}, 'filter1': [{'ParentImage|endswith': '\\SavService.exe'}, {'ParentImage|contains': ['\\System32\\', '\\SysWOW64\\']}], 'filter2': {'ParentImage|contains': ['\\Windows Defender\\', '\\Microsoft Security Client\\'], 'ParentImage|endswith': '\\MsMpEng.exe'}, 'filter_null': {'ParentImage': None}, 'condition': 'selection and not filter1 and not filter2 and not filter_null'}",['Some security products seem to spawn these'],G0006
